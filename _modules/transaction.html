
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>transaction &#8212; monopoly-analysis 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">monopoly-analysis 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for transaction</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Transaction Module</span>
<span class="sd">-----------------</span>

<span class="sd">Transaction module makes the actions into the pre SQL script.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">configuration</span>
<span class="kn">import</span> <span class="nn">database</span>
<span class="kn">import</span> <span class="nn">service</span>


<span class="c1"># --- Player / User Related Transaction ---------------------------------</span>


<div class="viewcode-block" id="add_user"><a class="viewcode-back" href="../code-transaction.html#transaction.add_user">[docs]</a><span class="k">def</span> <span class="nf">add_user</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create a transaction that will add user to the database</span>

<span class="sd">    Args:</span>
<span class="sd">        username: name of the user (username) that will be added</span>
<span class="sd">        sequence:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">starter_money</span> <span class="o">=</span> <span class="n">configuration</span><span class="o">.</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;starter_money&#39;</span><span class="p">]</span>

    <span class="n">database</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="n">username</span><span class="p">,</span> <span class="n">starter_money</span><span class="p">,</span> <span class="n">sequence</span><span class="p">,</span> <span class="n">starter_money</span><span class="p">])</span></div>


<div class="viewcode-block" id="delete_user"><a class="viewcode-back" href="../code-transaction.html#transaction.delete_user">[docs]</a><span class="k">def</span> <span class="nf">delete_user</span><span class="p">(</span><span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Delete the user from the database, because they have bankrupt or quit the game</span>

<span class="sd">    Args:</span>
<span class="sd">        username (str): name of the user that will be deleted from Player table</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">database</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span> <span class="n">ref_column_name</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">ref_values</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="reorder_user"><a class="viewcode-back" href="../code-transaction.html#transaction.reorder_user">[docs]</a><span class="k">def</span> <span class="nf">reorder_user</span><span class="p">(</span><span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_order</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Reorder the user into different sequence</span>

<span class="sd">    Args:</span>
<span class="sd">        username (str):</span>
<span class="sd">        new_order (int):</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="check_user"><a class="viewcode-back" href="../code-transaction.html#transaction.check_user">[docs]</a><span class="k">def</span> <span class="nf">check_user</span><span class="p">(</span><span class="n">player</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Check that the username is duplicated or not</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">database</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span> <span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="n">player</span><span class="p">)</span></div>


<div class="viewcode-block" id="count_user"><a class="viewcode-back" href="../code-transaction.html#transaction.count_user">[docs]</a><span class="k">def</span> <span class="nf">count_user</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Count user that is in the game</span>

<span class="sd">    Returns:</span>
<span class="sd">        result from database.count()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">database</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Player&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="list_user"><a class="viewcode-back" href="../code-transaction.html#transaction.list_user">[docs]</a><span class="k">def</span> <span class="nf">list_user</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; List the user that is in the game</span>

<span class="sd">    Returns:</span>
<span class="sd">        result from database.select(&#39;username&#39;, &#39;Player&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">database</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">)</span></div>


<span class="c1"># --- Property Transaction ----------------------------------------------</span>


<div class="viewcode-block" id="buy_property"><a class="viewcode-back" href="../code-transaction.html#transaction.buy_property">[docs]</a><span class="k">def</span> <span class="nf">buy_property</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">asset</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Buy a property that is not currently owned</span>

<span class="sd">    NOTE: Program will check for money. If not, it will raise TransactionError</span>

<span class="sd">    Args:</span>
<span class="sd">        player :</span>
<span class="sd">        asset :</span>
<span class="sd">        price :</span>

<span class="sd">    Raises:</span>
<span class="sd">        TransactionError :</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="sell_property"><a class="viewcode-back" href="../code-transaction.html#transaction.sell_property">[docs]</a><span class="k">def</span> <span class="nf">sell_property</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">asset</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sell property that player IS OWNING</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">        asset:</span>
<span class="sd">        price:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check property ownership</span>

    <span class="c1"># Check if the property have home / hotel inside</span>
    <span class="n">database</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;house_count&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;PlayerAsset&#39;</span><span class="p">)</span>

    <span class="c1"># Start the transaction</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="get_location"><a class="viewcode-back" href="../code-transaction.html#transaction.get_location">[docs]</a><span class="k">def</span> <span class="nf">get_location</span><span class="p">(</span><span class="n">user_sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Get the user location from user sequence</span>

<span class="sd">    Args:</span>
<span class="sd">        user_sequence:</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">database</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;location&#39;</span><span class="p">,</span>
                           <span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span>
                           <span class="n">ref_column_name</span><span class="o">=</span><span class="s1">&#39;sequence&#39;</span><span class="p">,</span>
                           <span class="n">operator</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">,</span>
                           <span class="n">quantity</span><span class="o">=</span><span class="n">user_sequence</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_property"><a class="viewcode-back" href="../code-transaction.html#transaction.get_property">[docs]</a><span class="k">def</span> <span class="nf">get_property</span><span class="p">(</span><span class="n">asset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Retrieve player that owns the &lt;asset&gt;</span>

<span class="sd">    Args:</span>
<span class="sd">        asset: (String or String List) Property name that doesn&#39;t know owner</span>


<span class="sd">    Returns:</span>
<span class="sd">        player: (String) player&#39;s username that owns the property. If not owned, will return None</span>
<span class="sd">    &quot;&quot;&quot;</span></div>
    <span class="c1"># return database.select(column_name=&#39;&#39;)</span>


<div class="viewcode-block" id="set_property"><a class="viewcode-back" href="../code-transaction.html#transaction.set_property">[docs]</a><span class="k">def</span> <span class="nf">set_property</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">asset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Assign &lt;asset&gt; to the &lt;player&gt;</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">        asset:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span></div>


<div class="viewcode-block" id="transfer_property"><a class="viewcode-back" href="../code-transaction.html#transaction.transfer_property">[docs]</a><span class="k">def</span> <span class="nf">transfer_property</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">new_player</span><span class="p">,</span> <span class="n">asset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Transfer property&#39;s ownership</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">        new_player:</span>
<span class="sd">        asset:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<span class="c1"># --- Money Transaction -------------------------------------------------</span>


<div class="viewcode-block" id="get_money"><a class="viewcode-back" href="../code-transaction.html#transaction.get_money">[docs]</a><span class="k">def</span> <span class="nf">get_money</span><span class="p">(</span><span class="n">player</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Check player money balance</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create transaction to check player money balance</span>

    <span class="c1"># Return the money amount</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="set_money"><a class="viewcode-back" href="../code-transaction.html#transaction.set_money">[docs]</a><span class="k">def</span> <span class="nf">set_money</span><span class="p">(</span><span class="n">player</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">money</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Set the money balance to the database</span>

<span class="sd">    This method is different from transaction.add_money that, this SET the new value</span>
<span class="sd">    While the add_money increases the money</span>

<span class="sd">    Args:</span>
<span class="sd">        player (str): name of the user (not ID)</span>
<span class="sd">        money (float or int): money that will be set</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">database</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span> <span class="n">set_column_name</span><span class="o">=</span><span class="s1">&#39;money&#39;</span><span class="p">,</span> <span class="n">set_column_quantity</span><span class="o">=</span><span class="n">money</span><span class="p">,</span> <span class="n">ref_column</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span>
                    <span class="n">ref_column_quantity</span><span class="o">=</span><span class="n">player</span><span class="p">)</span></div>


<div class="viewcode-block" id="add_money"><a class="viewcode-back" href="../code-transaction.html#transaction.add_money">[docs]</a><span class="k">def</span> <span class="nf">add_money</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">money</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Add money to the player in specific amount</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">        money:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">database</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span> <span class="n">set_column_name</span><span class="o">=</span><span class="s1">&#39;money&#39;</span><span class="p">,</span> <span class="n">set_column_quantity</span><span class="o">=</span><span class="s1">&#39;money + </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">money</span><span class="p">),</span>
                    <span class="n">ref_column</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">ref_column_quantity</span><span class="o">=</span><span class="n">player</span><span class="p">)</span></div>


<span class="c1"># --- House Transaction -------------------------------------------------</span>


<div class="viewcode-block" id="buy_house"><a class="viewcode-back" href="../code-transaction.html#transaction.buy_house">[docs]</a><span class="k">def</span> <span class="nf">buy_house</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">asset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">money</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Create a transaction when user want to buy a property</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">        asset:</span>
<span class="sd">        money:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Retrieve data from the database</span>
    <span class="n">house_count</span> <span class="o">=</span> <span class="n">get_house</span><span class="p">(</span><span class="n">asset</span><span class="p">)</span> <span class="k">if</span> <span class="n">player</span> <span class="o">==</span> <span class="n">get_property</span><span class="p">(</span><span class="n">asset</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="c1"># Data validation</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">house_count</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">house_count</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Property cannot have more than 4 home&quot;</span><span class="p">)</span>

    <span class="c1"># Check property ownership + money + current house count</span>

    <span class="c1"># Check if any parameter is invalid</span>

    <span class="c1"># If still good, normalized some parameters</span>
    <span class="n">asset</span> <span class="o">=</span> <span class="n">property_name_to_property_id</span><span class="p">(</span><span class="n">asset</span><span class="p">)</span>

    <span class="c1"># If still good, make transaction to database</span>
    <span class="n">database</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;PlayerAsset&#39;</span><span class="p">,</span> <span class="n">set_column_name</span><span class="o">=</span><span class="s1">&#39;house_count&#39;</span><span class="p">,</span> <span class="n">set_column_quantity</span><span class="o">=</span><span class="n">house_count</span><span class="p">,</span>
                    <span class="n">ref_column</span><span class="o">=</span><span class="s1">&#39;asset_id&#39;</span><span class="p">,</span> <span class="n">ref_column_quantity</span><span class="o">=</span><span class="n">asset</span><span class="p">)</span></div>

    <span class="c1"># return</span>


<div class="viewcode-block" id="sell_house"><a class="viewcode-back" href="../code-transaction.html#transaction.sell_house">[docs]</a><span class="k">def</span> <span class="nf">sell_house</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">asset</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sell the house, at a fixed rate</span>

<span class="sd">    Notes: House reselling rate is in the configuration file. You can edit it.</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">        asset:</span>
<span class="sd">        amount:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Retrieve the data from the database</span>
    <span class="n">database</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;PlayerAsset&#39;</span><span class="p">)</span></div>

    <span class="c1"># Data Input validation</span>
    <span class="c1"># if amount &lt;= 0 or amount &gt;= 5:</span>
    <span class="c1">#     raise ValueError(&quot;You cannot sell house that you do not own&quot;)</span>

    <span class="c1"># Check property ownership + money + current house count</span>

    <span class="c1"># Check if any parameter is invalid</span>

    <span class="c1"># If still good, make transaction to database</span>


<div class="viewcode-block" id="get_house"><a class="viewcode-back" href="../code-transaction.html#transaction.get_house">[docs]</a><span class="k">def</span> <span class="nf">get_house</span><span class="p">(</span><span class="n">asset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Get house count from the asset given</span>

<span class="sd">    Args:</span>
<span class="sd">        asset:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span>
        <span class="n">database</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;house_count&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;PlayerAsset&#39;</span><span class="p">,</span> <span class="n">ref_column_name</span><span class="o">=</span><span class="s1">&#39;propertyId&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">,</span>
                        <span class="n">quantity</span><span class="o">=</span><span class="n">asset</span><span class="p">))</span></div>


<div class="viewcode-block" id="property_name_to_property_id"><a class="viewcode-back" href="../code-transaction.html#transaction.property_name_to_property_id">[docs]</a><span class="k">def</span> <span class="nf">property_name_to_property_id</span><span class="p">(</span><span class="n">property_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Convert the property name to id (for database queries)</span>

<span class="sd">    Args:</span>
<span class="sd">        property_name:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">database</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;Asset&#39;</span><span class="p">,</span> <span class="n">ref_column_name</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="s1">&#39;=&#39;</span><span class="p">,</span>
                           <span class="n">quantity</span><span class="o">=</span><span class="n">property_name</span><span class="p">)</span></div>


<span class="c1"># --- Hotel Transaction -------------------------------------------------</span>


<div class="viewcode-block" id="buy_hotel"><a class="viewcode-back" href="../code-transaction.html#transaction.buy_hotel">[docs]</a><span class="k">def</span> <span class="nf">buy_hotel</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">asset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Buy a hotel to the property</span>

<span class="sd">    Complete when user can buy the hotel</span>
<span class="sd">    NOTE: Will delete house, because following the hotel buy rule</span>

<span class="sd">    Args:</span>
<span class="sd">        player (String) : username that wants to buy a hotel</span>
<span class="sd">        asset: (String) : property to buy a hotel</span>

<span class="sd">    Raises:</span>
<span class="sd">        TransactionError</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check Data Validation</span>

    <span class="c1"># Check property ownership</span>

    <span class="c1"># Check property hotel price</span>

    <span class="c1"># Check player money on hotel price</span>

    <span class="c1"># Create money transaction</span>

    <span class="c1"># Add hotel to the property</span>

    <span class="c1"># Remove all home from property</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="sell_hotel"><a class="viewcode-back" href="../code-transaction.html#transaction.sell_hotel">[docs]</a><span class="k">def</span> <span class="nf">sell_hotel</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">asset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sell the hotel to liquidise</span>

<span class="sd">    NOTE: 1 hotel = 5 house (in the need of selling the hotel)</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">        asset:</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check Data Validation</span>

    <span class="c1"># Check property eligibility</span>

    <span class="c1"># Check property hotel price</span>

    <span class="c1"># Check player money on hotel price</span>

    <span class="c1"># Create money transaction</span>

    <span class="c1"># Create property transaction</span>
    <span class="k">pass</span></div>


<span class="c1"># --- Player Valuation Transaction --------------------------------------</span>


<div class="viewcode-block" id="update_value"><a class="viewcode-back" href="../code-transaction.html#transaction.update_value">[docs]</a><span class="k">def</span> <span class="nf">update_value</span><span class="p">(</span><span class="n">player</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Update player value from the database</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="get_value"><a class="viewcode-back" href="../code-transaction.html#transaction.get_value">[docs]</a><span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="n">player</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Get the player&#39;s value</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="set_value"><a class="viewcode-back" href="../code-transaction.html#transaction.set_value">[docs]</a><span class="k">def</span> <span class="nf">set_value</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Set the value of the player with the value</span>

<span class="sd">    Args:</span>
<span class="sd">        player:</span>
<span class="sd">        value:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<span class="c1"># --- Mortgage Transaction ----------------------------------------------</span>


<div class="viewcode-block" id="get_mortgage_status"><a class="viewcode-back" href="../code-transaction.html#transaction.get_mortgage_status">[docs]</a><span class="k">def</span> <span class="nf">get_mortgage_status</span><span class="p">(</span><span class="n">asset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Get the mortgage status based on &lt;asset&gt; input listing</span>

<span class="sd">    Args:</span>
<span class="sd">        asset:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">database</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s1">&#39;is_mortgage&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;PlayerAsset&#39;</span><span class="p">))</span></div>


<div class="viewcode-block" id="set_mortgage_status"><a class="viewcode-back" href="../code-transaction.html#transaction.set_mortgage_status">[docs]</a><span class="k">def</span> <span class="nf">set_mortgage_status</span><span class="p">(</span><span class="n">asset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">status</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Set the mortgage status to the property</span>

<span class="sd">    Args:</span>
<span class="sd">        asset: property to be set status with</span>
<span class="sd">        status: status that property will have</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">database</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s1">&#39;PlayerAsset&#39;</span><span class="p">,</span> <span class="n">set_column_name</span><span class="o">=</span><span class="s1">&#39;is_mortgage&#39;</span><span class="p">,</span> <span class="n">set_column_quantity</span><span class="o">=</span><span class="n">status</span><span class="p">,</span>
                    <span class="n">ref_column</span><span class="o">=</span><span class="s1">&#39;assetId&#39;</span><span class="p">,</span> <span class="n">ref_column_quantity</span><span class="o">=</span><span class="n">property_name_to_property_id</span><span class="p">(</span><span class="n">asset</span><span class="p">))</span></div>


<div class="viewcode-block" id="mortgage"><a class="viewcode-back" href="../code-transaction.html#transaction.mortgage">[docs]</a><span class="k">def</span> <span class="nf">mortgage</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">asset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Mortgage the property and add money to player</span>

<span class="sd">    Args:</span>
<span class="sd">        asset:</span>
<span class="sd">        player:</span>
<span class="sd">    &quot;&quot;&quot;</span></div>
    <span class="c1"># database.update(set_column_name=&#39;is_mortgage&#39;, table_name=&#39;PlayerAsset&#39;, set_column_quantity=&#39;True&#39;)</span>


<div class="viewcode-block" id="remortgage"><a class="viewcode-back" href="../code-transaction.html#transaction.remortgage">[docs]</a><span class="k">def</span> <span class="nf">remortgage</span><span class="p">(</span><span class="n">asset</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Remortgage the property</span>

<span class="sd">    Args:</span>
<span class="sd">        asset:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<span class="c1"># Composite Transaction -------------------------------------------------</span>


<div class="viewcode-block" id="transfer"><a class="viewcode-back" href="../code-transaction.html#transaction.transfer">[docs]</a><span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">new_player</span><span class="p">,</span> <span class="n">asset</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">money</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Transfer money and/or asset from player -&gt; new player</span>

<span class="sd">    Args:</span>
<span class="sd">        player (String) : Player that starts the transfer</span>
<span class="sd">        new_player (String) : Player that will get the benefit from the transfer</span>
<span class="sd">        asset: (List)</span>
<span class="sd">            Lists of asset that will be transferred to new_player from player</span>
<span class="sd">            If left blank, asset will not be transferred.</span>
<span class="sd">            If given incorrect property, will raised ValueError</span>
<span class="sd">        money: (Integer)</span>
<span class="sd">            Money that will be transferred to new_player from player</span>
<span class="sd">            If left blank or zero, money will not be transferred and raised ValueError</span>
<span class="sd">            If left negative, money will not be transferred and raised ValueError</span>
<span class="sd">    Raises:</span>
<span class="sd">        ValueError:</span>
<span class="sd">            Money data is not valid</span>
<span class="sd">            Property data is not valid</span>
<span class="sd">        TransactionException:</span>
<span class="sd">            Raised when transaction is not completed, resulted from errors</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">check_property_validation</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">property_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check asset ownership validation</span>

<span class="sd">        Args:</span>
<span class="sd">            username:</span>
<span class="sd">            property_name:</span>

<span class="sd">        Returns:</span>
<span class="sd">            1 if player owned that asset, else 0</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="p">(</span><span class="n">username</span> <span class="o">==</span> <span class="n">get_property</span><span class="p">(</span><span class="n">property_name</span><span class="p">))</span> <span class="k">else</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">check_money_validation</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">money_value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Check money validation</span>

<span class="sd">        Args:</span>
<span class="sd">            username:</span>
<span class="sd">            money_value:</span>

<span class="sd">        Returns:</span>
<span class="sd">            1 if enough, else 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="p">(</span><span class="n">money_value</span> <span class="o">&lt;=</span> <span class="n">get_money</span><span class="p">(</span><span class="n">username</span><span class="p">))</span> <span class="k">else</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">do_transaction</span><span class="p">(</span><span class="n">sender_player</span><span class="p">,</span> <span class="n">receive_player</span><span class="p">,</span> <span class="n">asset</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">money</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            sender_player:</span>
<span class="sd">            receive_player:</span>
<span class="sd">            asset:</span>
<span class="sd">            money:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="c1"># transaction.transfer() starts here ----------------------------</span>
    <span class="k">if</span> <span class="n">asset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">asset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="c1"># Start coding transfer() here</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">asset</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Check each asset ownership</span>
        <span class="k">pass</span>

    <span class="k">if</span> <span class="n">money</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Check player&#39;s money balance</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">check_money_validation</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">money</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="ow">not</span> <span class="n">check_property_validation</span><span class="p">(</span><span class="n">player</span><span class="p">,</span> <span class="n">asset</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">TransactionError</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Start the real transaction process</span>
            <span class="k">pass</span></div>
            <span class="c1"># transfer_money(player, new_player, money)</span>


<div class="viewcode-block" id="load_property"><a class="viewcode-back" href="../code-transaction.html#transaction.load_property">[docs]</a><span class="k">def</span> <span class="nf">load_property</span><span class="p">(</span><span class="n">asset_reference_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        asset_reference_file:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">asset_reference_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>

            <span class="c1"># Remove the line that have no id</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                <span class="k">continue</span>

            <span class="c1"># Remove all space + convert to list</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

            <span class="c1"># Insert the record to the database</span>
            <span class="n">database</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s1">&#39;Asset&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
        <span class="n">service</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Cannot load property file&#39;</span><span class="p">)</span></div>


<span class="c1"># --- Custom-defined Exception -------------------------------------------</span>


<div class="viewcode-block" id="TransactionError"><a class="viewcode-back" href="../code-transaction.html#transaction.TransactionError">[docs]</a><span class="k">class</span> <span class="nc">TransactionError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Will rise when the transaction cannot be completed</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">errors</span><span class="p">):</span>
        <span class="c1"># Call the base class constructor with the parameters it needs</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="c1"># Now for your custom code...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errors</span> <span class="o">=</span> <span class="n">errors</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">monopoly-analysis 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Kunanon S..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>